= MySQL
:toc: left
:toclevels: 3
:sectnums:
:stylesheet: myAdocCss.css

'''



== 安装 mysql

中文文档 https://www.mysqlzh.com/doc/24.html

[.small]
[options="autowidth" cols="1a,1a"]
|===
|Header 1 |Header 2

|mysql 下载地址:
|https://dev.mysql.com/downloads/mysql/

image:/img/0001.png[,%]

image:/img/0002.png[,%]

|解压后, 复制到这个目录中: C:\Program Files\mysql-9.4.0-winx64
|image:/img/0003.png[,%]

|在你的mysql该目录下, 创建 my.ini 配置文件
|image:/img/0004.png[,%]

输入如下内容:
....
[client]
# 设置mysql客户端默认字符集
default-character-set=utf8

[mysqld]
# 设置3306端口
port=3306

# 设置mysql的安装目录
basedir=C:\Program Files\mysql-9.4.0-winx64

# 设置 mysql数据库的数据的存放目录，MySQL 8+ 不需要以下配置，系统自己生成即可，否则有可能报错
# datadir=C:\\web\\sqldata
# 允许最大连接数
max_connections=20
# 服务端使用的字符集默认为8比特编码的latin1字符集
character-set-server=utf8
# 创建新表时将使用的默认存储引擎
default-storage-engine=INNODB
....


|初始化数据库
|用管理员身份, 打开 win PowerShell, 依次执行以下命令:

- cd "C:\Program Files\mysql-9.4.0-winx64" //注意: 必须加双引号, 因为在 PowerShell 中，路径中包含空格的话, 会导致 PowerShell 无法识别它是一个完整的路径，而是将其分开处理了。 解决方法是: #*如果路径包含空格，你需要用引号将整个路径括起来。*# 或者使用 Tab 键自动补全。当你输入 cd C:\Pro 后，按一下 Tab 键，PowerShell 就会自动帮你补全并加上引号.
- cd bin
- .\mysqld --initialize --console //#*注意: 你需要在命令前面加上 .\ 来明确告诉 PowerShell：“我要执行的是当前目录下的这个程序”。
.\ 代表“当前目录”。*#


image:/img/0005.png[,%]

image:/img/0006.png[,%]

image:/img/0007.png[,%]

|将mysql 变成一个服务, 以后就可以直接启动这个服务了
|输入:

- ./mysqld install mysqlZZZ //制作一个名叫 mysqlZZZ 的服务

要启动该服务时, 输入以下命令即可:

- net start mysqlZZZ

要关闭该服务时, 输入以下命令即可:

- net stop mysqlZZZ

image:/img/0008.png[,%]


image:/img/0009.png[,%]

|===


'''

== 登录 MySQL

当 MySQL 服务已经运行时, 我们可以通过 MySQL 自带的客户端工具登录到 MySQL 数据库中, 首先打开命令提示符, 输入以下格式的命名:

....
mysql -h 主机名 -u 用户名 -p
....

参数说明：

....
-h : 指定客户端所要登录的 MySQL 主机名, 登录本机(localhost 或 127.0.0.1)该参数可以省略;
-u : 登录的用户名;
-p : 告诉服务器将会使用一个密码来登录, 如果所要登录的用户名密码为空, 可以忽略此选项。
....

如果我们要登录本机的 MySQL 数据库，只需先进入bin目录 (C:\Program Files\mysql-9.4.0-winx64\bin), 再输入以下命令即可：

- net start mysqlZZZ
-  ./mysql -u root -p



image:/img/0010.png[,%]




'''

== 修改你的root 密码

在您第一次使用 mysqld --initialize 命令初始化 MySQL 服务器时, --initialize 命令会随机为 root 用户生成一个临时密码，并将其保存在日志文件中（或者在控制台中显示）。*为了安全起见，MySQL 强制您在第一次登录后立即修改这个临时密码。在您修改密码之前，您无法执行任何数据库操作，比如 SHOW DATABASES;。*


您需要使用 ALTER USER 语句, 来修改您的 root 用户的密码。请在 mysql> 提示符下执行以下命令：

[source, sql]
....
ALTER USER 'root'@'localhost' IDENTIFIED BY '新密码';
....

分号：请记得在命令的末尾加上分号 ;。

image:/img/0011.png[,%]



'''

== 列出所有可用的数据库 -> SHOW DATABASES;

image:/img/0013.png[,%]

image:/img/0014.png[,%]


成功连接到 MySQL 后，你可以在命令行中直接执行 SQL 查询。

列出所有可用的数据库： +
SHOW DATABASES;

选择要使用的数据库： +
USE your_database;

列出所选数据库中的所有表： +
SHOW TABLES;

退出 mysql> 命令提示窗口可以使用 exit 命令，如下所示： +
EXIT;

或者使用： +
QUIT;

'''




== #数据库#, 增删改查

mysql 中, 有"数据库", 和"数据表"的概念. +
数据库, 就相当于是文件夹 +
数据表, 就相当于是 excel 文件.

==== 创建数据库 -> CREATE DATABASE 数据库名;


'''

== 数据类型

==== 长文本类型

在 MySQL 中，如果需要存储 ​​不限长度的文本段落​​（可能很长），你可以选择以下几种 ​​TEXT​​ 类型，具体取决于你的需求：

[.small]
[options="autowidth" cols="1a,1a"]
|===
|Header 1 |Header 2

|1.TEXT类型（适合大多数长文本）​​
|最大长度​​：约 ​​65,535 字符​​（64KB） +

在UTF-8 编码中，一个中文字符通常占用1 到3 个字节，所以65,535 字节可以存储大约21,845 个中文字符（65,535 / 3 ≈ 21,845），如果使用2个字节来存储中文字符，则可以存储32767个字符。


​​适用场景​​：*文章、评论、描述等普通长文本* +

​​示例​​：

[source, sql]
....
CREATE TABLE articles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    content TEXT  -- 存储长文本
);
....

|2.MEDIUMTEXT（适合更长的内容，如博客文章、文档）​​
|最大长度​​：约 ​​16,777,215 字符​​（16MB） +
​​适用场景​​：*较长的文章、HTML 内容、JSON 数据等*

​​示例​​：

[source, sql]
....
CREATE TABLE blog_posts (
    id INT PRIMARY KEY AUTO_INCREMENT,
    body MEDIUMTEXT  -- 存储更长的文本
);
....

|3.LONGTEXT（适合超长文本，如书籍、大型文档）​​
|最大长度​​：约 ​​4,294,967,295 字符​​*（4GB）* +
​​适用场景​​：*电子书、大型报告、XML/JSON 数据等*

​​示例​​：

[source, sql]
....
CREATE TABLE books (
    id INT PRIMARY KEY AUTO_INCREMENT,
    full_text LONGTEXT  -- 存储超长文本
);
....

|4.VARCHAR（如果长度可控，比如几千字符以内）​​
|最大长度​​：最多 ​​65,535 字节​​（实际字符数取决于编码，如 UTF-8 下约 21,844 字符） +
​​适用场景​​：较短的段落，如简介、标题等

示例：

[source, sql]
....
CREATE TABLE comments (
    id INT PRIMARY KEY AUTO_INCREMENT,
    comment VARCHAR(10000)  -- 存储较长的评论
);
....
|===


如果你的文本 ​​可能很长​​（如文章、书籍），建议使用 MEDIUMTEXT或 LONGTEXT。 +
如果只是 ​​段落级别​​（如评论、简介），TEXT通常足够。

具体也可查看教程文档 +
https://www.runoob.com/mysql/mysql-data-types.html


插入段落:

image:/img/0041.png[,%]

'''

== 当你有多个数据库时, 要把你执行的那个, 设置为默认数据库, 再来写命令语句, 才不会报错

image:/img/0042.png[,%]



== #数据表#

==== 增

创建一张表:
....
create table table_专业(  //注意: 这里要用小括号, 而不是大括号!
	id int,              //注意, 里面的字段, 必须用逗号作为结尾
	str专业名 varchar(16)      //但最后一个字段, 不需要标点
);      //最后的小括号外, 需要分号
....


image:/img/0036.png[,%]

image:/img/0037.png[,%]

image:/img/0038.png[,%]

'''

==== 复制表

命令是:

[source, sql]
....
CREATE TABLE new_table LIKE old_table;
INSERT INTO new_table SELECT * FROM old_table;
....


如

[source, sql]
....
# 对tab1 表, 复制出一个新的tab2 表来
CREATE TABLE tab2 LIKE tab1;
INSERT INTO tab2 SELECT * FROM tab1;
....

image:/img/0047.png[,%]

'''

====  删 -> DROP TABLE 表名;

[.small]
[options="autowidth" cols="1a,1a"]
|===
|Header 1 |Header 2

|直接删除表，不检查是否存在
|DROP TABLE table_name;

|会检查是否存在，如果存在则删除
|DROP TABLE [IF EXISTS] table_name;

|如果你只是想删除表中的所有数据，但保留表的结构
|TRUNCATE TABLE table_name; +
这会清空表中的所有数据，但不会删除表本身。
|===




'''


==== 数据表 : 改

image:/img/0039.png[,%]

image:/img/0040.png[,%]


==== 数据表 : 查

[source, sql]
....

select * from tab2; # 查询tab2 表中的所有数据
....

image:/img/0052.png[,%]


[source, sql]
....

select 用户名, age from tab2; # 只查看显示tab2表中的 "用户名"和 age 列中的值
....

image:/img/0053.png[,%]


[source, sql]
....

select 用户名 as name, age from tab2;
# 只查看显示tab2表中的 "用户名"和 age 列中的值, 但临时将"用户名"字段, 显示成"name"字段名.
....

image:/img/0054.png[,%]


[source, sql]
....
select * from tab2 where is_active !=0;
# 只查看显示tab2表中的 is_active 列中的值不为0 的所有行数据
....

image:/img/0055.png[,%]



'''


== 在表中对"#行"做操作#

==== #★ 增加行#


命令:


....
insert into 表明 (列名1,列名2,列名3) values (列名1的值,列名2的值,列名3的值)
....

如

[source, sql]
....
#在 tab1 表中, 插入一行数据
INSERT INTO tab1 (id,用户名,生日,is_active) values (Null,'zrx', '1981-08-16',1);  # 这里，NULL 是用于"自增长"列的占位符，表示系统将为 id 列生成一个唯一的值。
....

image:/img/0044.png[,%]

image:/img/0043.png[,%]


还可以同时插入多行

[source, sql]
....
INSERT INTO tab1 (id,用户名,生日,is_active) values
(Null,'zrx', '1981-08-16',1),   # 注意, 非最后一行的数据, 要用逗号结尾.
(Null,'wyy', '1992-05-12',1),
(Null,'zzr', '1988-09-06',1);  # 最后一行的数据, 才用分号结尾
....

image:/img/0045.png[,%]


你也可以简化的来写, 不用写列名, 直接写上values值即可

[source, sql]
....
insert into tab1 values
(Null, 'girl1', '1992-03-02',0),
(Null, 'girl2', '1997-04-22',0);
....

image:/img/0046.png[,%]


'''

==== 清空表中所有内容


[source, sql]
....
SET SQL_SAFE_UPDATES = 0; # 注意: 默认情况下, mysql有安全模式, 禁止清空表中的所有内容. 如果你要执行清空命令, 必须先禁用该安全模式, 即输入本行代码才行.
delete from tab2  # 清空 tab2 表中的所有数据
....


==== 按条件, 删除数据

[source, sql]
....
delete from tab2 where 用户名='zrx';  # 删除tab2表中, 用户名字段为zrx 的所有行. 注意, 对于字符串值, 必须用单引号, 而不是双引号!

delete from tab2 where 用户名='zrx' and is_active =0;  # 删除tab2表中, 用户名字段为zrx, 且 is_active=0 的所有行. 注意: 字段名不要用单引号来包裹! (​列名不要加引号​​（除非有特殊字符，用反引号 `）),  数字值也不要用单引号包裹!


delete from tab2 where  is_active >0;  #  删除tab2表中, is_active字段的值大于0的所有行数据.
....

image:/img/0048.png[,%]


'''

==== #★ 修改行中的数据#

格式是:

[source, sql]
....
update 表名 set 列名=新值;
update 表名 set 列名=新值 where 条件;
....


如
[source, sql]
....
update tab2 set 用户名='张三'; #将tab2表中所有行数据的"用户名"字段的值, 都改成'张三'
....

image:/img/0049.png[,%]


[source, sql]
....
update tab2 set 用户名='李四' where id=16; #将tab2表中id=16那一行的"用户名"字段的值, 改成'李四'
....

image:/img/0050.png[,%]


[source, sql]
....

update tab2 set age =age+10; # 将 tab2表中的每一行的age值, 都在原基础上增加10
....



'''

== 表, 列操作

==== ★ #对表中增加列(增加字段)#

使用ALTER TABLE语句来向表中添加新的列。

格式
....
ALTER TABLE table_name
ADD column_name column_definition [FIRST|AFTER existing_column];
....

- table_name 是你想要添加列的表名。
- column_name 是你想要添加的列的名称。
- column_definition 定义了列的数据类型、是否允许为空、是否有默认值等属性。
- FIRST（可选）表示将新列添加为表中的第一列。
- AFTER existing_column（可选）表示将新列添加在existing_column之后。

假设你有一个名为students的表，你想添加一个名为email的新列，数据类型为VARCHAR(255)，并且不允许为空，你可以使用以下SQL语句：

[source, sql]
....
ALTER TABLE students
ADD COLUMN email VARCHAR(255) NOT NULL;
....

如果你想将email列, 添加为表中的第一列，可以使用：

[source, sql]
....
ALTER TABLE students
ADD COLUMN email VARCHAR(255) NOT NULL FIRST;
....

如果你想将email列, 添加在name列之后，可以使用：

[source, sql]
....
ALTER TABLE students
ADD COLUMN email VARCHAR(255) NOT NULL AFTER name;
....


默认值：如果需要，可以指定一个默认值。例如：

[source, sql]
....
ALTER TABLE students
ADD COLUMN email VARCHAR(255) NOT NULL DEFAULT 'default@example.com';
....


如

[source, sql]
....
alter table tab2
add column age TINYINT default null after 用户名 ;  # 对tab2 表格增加一列 age, 位置放在 "用户名"列 的后面.
....



image:/img/0051.png[,%]

'''

==== 删除列：

....
alter table 表名 drop column 列名;
....

如

[source, sql]
....
alter table tab2
drop column age; # 删除 tab2 表中的 age 列
....

'''








